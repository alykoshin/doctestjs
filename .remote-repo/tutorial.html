<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Doctest.js: a tutorial in test-drive Javascript</title>
<script src="doctest.js"></script>
<script type="text/javascript" src="./.resources/toc.js"></script>
<link rel="stylesheet" type="text/css" href="./.resources/doc.css" />
<link rel="stylesheet" type="text/css" href="doctest.css" />

</head>

<body class="autodoctest load-all-remotes">

<!-- HEADER --><a href="http://github.com/ianb/doctestjs"><img
style="position: absolute; top: 0; right: 0; border: 0;"
src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
alt="Fork me on GitHub" /></a>

<div id="container">

<div class="download">
 <a href="http://github.com/ianb/doctestjs/zipball/master">
  <img border="0" width="90"
   src="http://github.com/images/modules/download/zip.png" /></a>
 <a href="http://github.com/ianb/doctestjs/tarball/master">
  <img border="0" width="90"
   src="http://github.com/images/modules/download/tar.png" /></a>
</div>

<h1 class="title"><a href="http://github.com/ianb/doctestjs">doctest.js</a>
 <span class="small">by
 <a href="http://blog.ianbicking.org">Ian Bicking</a></span>
</h1>

<div>
<!-- /HEADER -->

<h2>Doctest/JS: unit testing for Javascript made simple</h2>

<div>
Author: Ian Bicking,
<a href="mailto:ian@ianbicking.org">ian@ianbicking.org</a>
</div>

<div id="contents"></div>

<h3>Introduction</h3>

<div>
  This document will show you how to use doctest.js, and hopefully give you some advice in testing Javascript in general.
</div>

<h3>The HTML Page</h3>

<div>
  The first thing you have to do is create an HTML page to do testing. Here's what a minimal page will look like:

  <pre src="blanktest.html"></pre>

</div>

<div>
  Of course, you may want to include doctestjs directly in your source tree instead of using the copies on <code>ianb.github.com/doctest</code> - in particular the hosted versions will be updated periodically and might break your tests.
</div>

<div>
  You'll also be including the library you are testing, and any of its prerequesites (e.g., jQuery, Underscore, etc) in <code>&lt;script&gt;</code> tags as well.  If you write helpers for your tests you might put them in as well.
</div>

<div>
  Finally the way I recommend writing tests you'll use:

  <pre>
    &lt;pre src="test-my-library.js" class="commenttest">&lt;/pre>
  </pre>

  This will load the tag up with the contents of <code>test-my-library.js</code> and treat it as a test.
</div>

<div>
  That's all you need to do in HTML to setup your test (though we'll talk about other things you can do when testing DOM code).  Now, on to actually writing tests!
</div>

<h3>Writing A Test</h3>

<div>
  Test take the form of some code, some calls to <code>print()</code>, and then an expectation of what was printed during that section of code.  A very minimal example:

  <pre>
    function b64url(s) {
      return btoa(s).replace(/\+/g, '-').replace(/\//g, '_').replace('=', '');
    }

    print(b64url('test'))
    // => not sure?
  </pre>

</div>

<div>
  This tests a function that produces <a href="http://en.wikipedia.org/wiki/Base64#URL_applications">Base64 URL</a> encoded text.  To test the function I used <code>print(b64url('test'))</code>.  Then I have a specially formatted comment that indicates what I expect to be output: <code>// => not sure?</code>.
</div>

<div>
Of course I don't expect it to output <code>not sure?</code> &mdash; but I can't calculate what the base64-encoded version of <code>'test'</code> is, so I just faked it.  Faking it is a good way to start with tests where you don't know what the right output is before running the test, but you'll know it when you see it.  Let's try actually running the test:

  <pre class="commenttest">
    function b64url(s) {
      return btoa(s).replace(/\+/g, '-').replace(/\//g, '_').replace('=', '');
    }

    print(b64url('test'))
    // => not sure?
  </pre>

</div>

<div>
  Oops! <code>dGVzdA</code> looks right, but I was expecting to strip <em>all</em> the <code>=</code> signs.  So, a quick modification of the function and test:

  <pre class="commenttest">
    function b64url(s) {
      return btoa(s).replace(/\+/g, '-').replace(/\//g, '_').replace(/=/g, '');
    }

    print(b64url('test'))
    // => dGVzdA
  </pre>

</div>




<div id="doctest-output"></div>


<!-- FOOTER --></div>

<div class="footer">
 get the source code on GitHub:
 <a href="http://github.com/ianb/doctestjs">ianb/doctestjs</a>
</div>

</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-6731441-12");
pageTracker._trackPageview();
} catch(err) {}</script>
<!-- /FOOTER -->

</body> </html>
